# 梦山 工程技术规范 (Technical Engineering Spec)

> **目标**: 统一项目的技术栈、代码风格与数据规范，确保所有设计文档的技术描述一致。
> **责任人**: 技术总监 (Tech Director)
> **文档状态**: Demo 阶段草案
> **更新日期**: 2026-02-07

---
## 1. 技术栈 (Tech Stack)

### 1.1 核心语言
*   **客户端**: Unreal Engine 5 (C++ / Blueprint)
*   **服务器**: [待定：Golang / Java / C#]
*   **脚本语言**: [Lua / None]

> **选型说明**: 已选用 UE5；攀岩物理与 Chaos 物理、协作手感需优先验证；光遇已验证多端情感社交，需考虑 iOS/Android/PC 同服。

### 1.2 网络模型 (Networking)
*   **类型**: [待定：状态同步 / 帧同步] — 攀岩协作需实时同步位移与托举/拉拽状态。
*   **权威性**: [待定：服务器校验 / 客户端先行]
*   **Demo 验证项**: 弱网/高延迟（如 150ms+）下协作仍可完成，无频繁断线或动作错位。

---
## 2. 数据规范 (Data Standards)

### 2.1 配置表 (Config)
*   **格式**: [Excel / JSON / CSV]
*   **加载方式**: [启动全加载 / 按需加载]
*   **验证规则**:
    *   ID 必须为 `int32` 且 `>0`。
    *   资源路径必须相对于 `Assets/Res/`。

### 2.2 存档数据 (Save Data)
*   **序列化**: [Protobuf / JSON / Binary]
*   **兼容性**: 必须支持字段新增的向后兼容。
*   **关系数据**: 挚友关系、攀登进度、情境解锁状态需持久化。

---
## 3. 命名约定 (Naming Conventions)

| 类型 | 风格 | 示例 |
| :--- | :--- | :--- |
| **变量/字段** | camelCase | `playerHealth` |
| **函数/方法** | PascalCase | `GetPlayerInfo` |
| **类/接口** | PascalCase | `PlayerManager` |
| **常量/枚举** | UPPER_SNAKE_CASE | `MAX_PLAYER_COUNT` |

---
## 4. 目录结构 (Directory Structure)

*   脚本: `Assets/Scripts/...`
*   资源: `Assets/Res/...`
*   配置: `Config/Excel/...`
*   [待补充：攀爬、协作、关系等模块的具体目录划分]

---
## 5. 性能预算 (Performance Budget)

> **目标机型**: [待定：iPhone 11 / Galaxy S20 / PC GTX 1060]

| 指标 (Metric) | 预算 (Budget) | 备注 (Note) |
| :--- | :--- | :--- |
| **内存 (Memory)** | < 600 MB | 低端机峰值 |
| **DrawCalls** | < 200 | 攀爬场景 |
| **同屏人数** | < 10 | 协作场景多为 2–4 人 |
| **网络包量** | < 5 KB/s | 移动网络下行，攀岩协作需低延迟 |
| **Loading** | < 3 sec | 单段路线场景切换 |
| **协作同步延迟** | < 150ms 可玩 | Demo 必须验证 |

---
## 6. 日志与监控 (Logging & Monitoring)

*   **日志等级**: `DEBUG`, `INFO`, `WARN`, `ERROR`, `FATAL`
*   **埋点格式**: 必须包含 `timestamp`, `user_id`, `event_id`, `params_json`。
*   **异常上报**: 客户端 Crash 必须上报堆栈至 [Sentry/Bugly]。
*   **Demo 验证埋点**: 攀岩操作、协作成功/失败、陌生人匹配等待时间、关系建立转化。

---
## 7. Demo 技术验证清单

| 序号 | 验证项 | 通过标准 | 状态 |
| :--- | :--- | :--- | :--- |
| 1 | 攀岩+协作手感 | 玩家能清晰感知「托举/拉拽」的物理反馈，协作成功时有明确成就感 | 待验证 |
| 2 | 网络同步 | 弱网/高延迟（如 150ms+）下协作仍可完成 | 待验证 |
| 3 | 陌生人匹配 | 匹配到的陌生人能自然进入协作，等待时间可接受 | 待验证 |
