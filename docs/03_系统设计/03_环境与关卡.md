# 梦山 系统设计规范 — 环境与关卡 (Environment & Level System Spec)

> **设计目的 (Design Goal)**  
> 定义关卡结构、环境危害对状态占段的影响（寒冷、中毒、受伤等）、以及主线/分支/协作节点配置的归属；与状态系统、攀爬、协作对接。
> **设计支柱引用**: [互助即玩法](../00_项目核心/02_Pillars_设计支柱.md)
> **关联文档**: [状态系统](04_状态系统.md)、[攀爬与移动](01_攀爬与移动.md)、[协作与救援](02_协作与救援.md)、[进度与复活点](07_进度与复活点.md)
> **更新日期**: 2026-02-09

---

## 1. 本规范覆盖范围

*   **环境危害与状态占段**：寒冷区域、毒性区域、摔落伤害等由关卡/环境配置触发，施加的占段（寒冷占段、中毒占段、受伤占段）及清除方式由《状态系统》定义；本规范仅声明「环境与关卡系统负责施加来源」，不做具体数值或设计上的新增或修改。
*   **主线/分支与协作节点**：主线路段所有节点必须设计为单人可攀爬通过；隐藏/分支路段可设计「单人难以完成、协作才有解法」的节点。详见《协作与救援》4.5 交互规则。
*   **待扩展**：区域划分（biome）、营地/篝火/祭坛位置、可攀爬斜面与支点配置、时间或重置规则等，随关卡设计文档补充。

### 1.1 PEAK 基础设计还原（参考）

*   **营地与祭坛位置**：PEAK 中营地篝火位于各 biome（区域）末端，祭坛在篝火旁；寒冷/毒区等环境危害在关卡中施加对应占段（蓝/紫等）。
*   **环境危害**：寒冷区域施加寒冷占段、毒性环境或误食毒果施加中毒占段、摔落造成受伤占段；清除方式见《状态系统》与《道具系统》。
*   **梦山保留**：主线路段单人可过；协作节点在隐藏/分支；见《协作与救援》4.5。

---

## 2. 与系统架构的映射

| 系统 | 本规范覆盖 |
| :--- | :--- |
| [SYS_ENV] 环境与关卡 | 环境危害施加占段、主线/分支划分、协作节点配置 |
| [SYS_STATE] 状态系统 | 寒冷/中毒/受伤等占段的来源与清除；见《状态系统》 |
| [SYS_CLIMB] 攀爬与移动 | 可攀爬斜面、支点、斜坡判定与关卡配置 |
| [SYS_PROGRESS] 进度与复活点 | 检查点、营地、祭坛位置；见《进度与复活点》 |

---

## 3. 关卡元素分类与自然支点

> 本节给出与攀爬体验强相关的关卡元素分类，具体数值与表现由对应系统补充。

### 3.1 攀爬相关元素

- **可攀爬斜面（Climbable Slope）**  
  - 判定逻辑：由《攀爬与移动》中的 `SLOPE_MIN_CLIMB_ANGLE` 等参数决定；  
  - 视觉要求：通过统一材质/法线/细节纹理，让玩家一眼能分辨「可攀爬」与「仅可行走」的表面。

- **自然支点（Rest Surface / 支点平台）**  
  - 定义：嵌在可攀爬斜面上的小平台、突起岩石、木桩等，角色可在此短暂停留调整节奏。  
  - 视觉要求：在统一世界观下，通过形状/亮度/局部特效（如略亮的岩面、积雪、小型岩台）与纯斜面区分，形成「这是可以喘口气的地方」的直觉。  
  - 行为规则（与《攀爬与移动》对齐）：  
    - 角色在自然支点区域内，且水平速度低于一定阈值（视为「停留」）时，攀爬体力消耗从 `CLIMB_STAMINA_COST_PER_SEC` 降低为 `CLIMB_STAMINA_COST_PER_SEC_REDUCED`，或在短时间内暂停消耗；  
    - **自然支点不会主动回体**：无论停留多久，都不会出现体力值正向回复；  
    - 若玩家在自然支点上保持静止超过 `{{REST_POINT_TRIGGER_MS}}` 后，系统应逐步恢复到正常或接近正常的体力消耗档位，以避免无限「挂机拖耗」的打法。

> 设计意图：自然支点提供的是「节奏与决策窗口」，而不是资源回复点。真正的体力恢复/解除占段依然由营地、道具或状态系统负责。

### 3.2 危险与威胁区域

- **环境危害区**（寒冷、中毒、坠石等）  
  - 通过颜色、粒子与环境音统一表达「威胁」，并在《状态系统》中定义对应占段类型与清除方式。  
  - 不允许出现「看上去安全、逻辑上却持续掉血/占段」的区域。

### 3.3 导航与氛围元素

- **导航元素**（路标、旗帜、绳索等）用于引导路线；  
- **氛围元素**（落樱、风、光束等）可与可行走面/可攀爬面做弱关联，但不得与实际判定冲突。

---

## 4. Demo 路线定位（主线路段代表性关卡）

### 4.1 身份与范围

- Demo 单段路线被定义为「主线路段的代表性关卡片段」，用于验证与展示正式游戏中主线攀爬体验的一段完整流程。  
- Demo 中不引入只在 Demo 出现、后续主线不会保留的特例机制；所有规则应可直接迁移到正式主线配置中。

### 4.2 单人可通关的强约束

- Demo 必须满足以下要求：  
  - 所有必经节点在理论上均可由单人通关，不允许出现数学上「必须协作才能通过」的硬协作锁。  
  - 协作行为仅能作为「降低失败率」「减少尝试次数」「缩短耗时」的手段，而非通关唯一解。  
- 当存在难度较高的路段时，其单人通关路径应通过更精细的操作与多次尝试仍可达成，协作仅作为更友好的路径选择。

### 4.3 协作节点的布置与标记

- Demo 中允许配置少量「协作加成节点」：  
  - 单人可以通过高精度攀爬与多次重试完成的高难段落；  
  - 若有队友配合托举、拉拽或使用道具，则能明显降低操作难度或减少体力消耗。  
- 关卡配置中需对这类节点进行显式标记：  
  - 在设计文档与工具中使用「协作加成节点」标识，而非「必协作节点」。  
  - 协作加成节点不得出现在主线单一必经路径的瓶颈位置，应预留「单人解法」或更加宽容的替代路线。

### 4.4 展示目标与节奏控制

- **玩法展示目标**：  
  - 展示攀爬本身的「路线阅读 → 试错 → 掌握节奏」过程，强调「登山感」与「自我掌控感」。  
  - 自然地暴露 1–2 个「如果有队友会更轻松」的场景，为后续双人情境做预热。  
- **氛围与节奏**：  
  - 通过远景、环境音与地形起伏，使 Demo 看起来像旅途中一段完整的记忆，而非纯粹的体力考试。  
  - 单段攀爬时长控制在 `{{DEMO_ROUTE_DURATION_MIN}}–{{DEMO_ROUTE_DURATION_MAX}}` 分钟，包含压力峰值与短暂的释放窗口（营地/观景点等）。

### 4.5 与设计支柱和系统架构的对齐

- 与「主线路段单人可过」的支柱保持一致：  
  - Demo 传达给玩家的预期应是「可以一个人走完全程」，而协作是锦上添花的选择，而非强制门槛。  
- 与「双人/多人情境是长期锚点」的对应关系：  
  - Demo 仅承担「尝鲜」与「预热」职责，让玩家感知到协作的存在与价值；  
  - 真正以双人为核心的长期情境，将由后续专门的双人关卡与系统承载，其规范见对应双人情境/关卡设计文档。  
- 与《05_SystemArch_系统架构》中的「5. 开发规划」对齐：  
  - Demo 被归类为 `[SYS_ROUTE]` 下「主线攀爬体验验证」的首批实现样本；  
  - 不代表双人情境系统的完整形态，仅为后续双人模块的体验引导与验证入口。
