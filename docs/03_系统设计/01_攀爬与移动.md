# 梦山 系统设计规范 — 攀爬与移动 (Climb & Movement System Spec)

> **核心体验锚点 (Core Aesthetics)**: 在旅途中，因一次真实的互助而与陌生人建立信任，共同克服障碍登顶的归属感。
> **设计支柱引用**: [互助即玩法](../00_项目核心/02_Pillars_设计支柱.md)
> **关联文档**: [02_协作与救援](02_协作与救援.md)（托举、拉拽、互助行为与关系门控）、[04_状态系统](04_状态系统.md)（体力消耗与 Action_Bar）
> **更新日期**: 2026-02-07

---

## 1. 挑战模型 (Challenge Model)

### 1.1 阻力来源 (Resistance)
*   [x] **操作精度 (Dexterity)**: 需要精准的支点选择、借力时机与协作配合。
*   [x] **协作协调 (Coordination)**: 托举/拉拽需要与搭档在时空上对齐。（详见《协作与救援》）
*   [ ] **时间压力 (Time Pressure)**: 可选；部分节点可设计限时借力。
*   [ ] **资源短缺 (Scarcity)**: 不用于核心攀爬；体力/次数限制需谨慎，避免影响核心体验。

### 1.2 核心动词 (Core Verb)
*   **攀爬 (Climbing)**: 抓取支点、位移、借力、失败重试。
*   **互助 (Cooperating)**: 托举、拉拽、借力——必须影响关卡进度或成败，而非仅社交动作；定义见《协作与救援》。

### 1.3 基础操作 (Basic Controls)

#### 1.3.1 PC 端输入与状态切换

- **道具栏与手持**
  - 数字键 `1`–`4`：对应 3 个物品栏 + 1 个背包栏。首次点击某栏位，将该栏位道具取在手中并高亮；再次点击可在栏位间切换或将当前手持道具放回该栏位（详见《道具系统》）。

- **移动与奔跑**
  - `W/A/S/D`：控制角色在地面上的移动（基础移动，按 `MOVE_SPEED`）。
  - `Shift + 方向键`：在地面上从走路切换为奔跑，按 `STAMINA_COST_RUN_PER_SEC` 持续消耗体力（详见《状态系统》）。

- **基础跳跃**
  - `Space`：在站立/移动/奔跑状态下触发「基础跳跃」，高度由 `JUMP_HEIGHT` 与重力共同决定；基础跳跃不消耗体力。

- **站立在地面且空手时**
  - `E`：对前方有效目标执行「交互」（如机关、他人背包、NPC 等）。
  - 长按鼠标右键 + 移动鼠标：转动视角。
  - 长按鼠标左键 / 虚拟「托举」按钮：在可站立平地进入「托举状态」（托举逻辑见《协作与救援》）。
  - 方向键 + 长按鼠标左键 / 虚拟「攀爬」按钮：当角色身体触碰到「可攀爬斜面」时，进入「攀爬状态」，具体规则见 4.1。

- **站立在地面且手持道具时**
  - `Q`（点按）：将当前手持道具放置在地面；长按 `Q` 视为「投掷」，用于抛掷道具（详见《道具系统》）。
  - `E`：当面向有效目标（如队友、他人背包）时，长按 `E` 触发「对目标使用道具 / 放入背包」的逻辑（见《道具系统》《协作与救援》）。
  - 长按鼠标左键：对自身使用当前手持道具，并显示使用进度条，同时作为防误触确认（见《道具系统》2.2）。
  - 鼠标右键：将当前手持道具放回对应物品栏，取消高亮选中。

- **攀爬状态下**
  - 角色处于「攀爬状态」时无法取出或持有地面道具，需先通过「释放支点」「攀爬跳跃」或自动站立等方式脱离攀爬。待于地面站定，方可再次使用道具相关操作。

- **持续动作的中断规则（通用）**
  - 标记为「持续」的动作（如奔跑体力消耗、攀爬、攀爬跳跃蓄力、长按使用道具等）在角色状态发生变化（如站立 → 下落 / 攀爬）或发生显著位移（如跳跃起跳、被拉拽 / 托举）时，会立即被中断，当前使用进度条清零，需要重新长按触发。

---

## 2. 体验循环 (Experience Loop)

```mermaid
graph LR
    Observe(观察: 支点/搭档位置) --> Decide(决策: 路线/协作时机)
    Decide --> Act(行动: 攀爬/托举/拉拽)
    Act --> Feedback(反馈: 成功登段/失败重试)
    Feedback --> Learn(学习: 修正节奏与配合)
    Learn --> Observe
```

### 循环详解
*   **观察**: 玩家需关注支点分布、搭档状态、协作触发区域。
*   **决策**: 面临「现在攀还是等搭档」「谁来托举/拉拽」等权衡。
*   **行动**: 攀爬输入（抓取/释放）、托举/拉拽输入（朝向、范围）；协作动作见《协作与救援》。
*   **反馈**: 位移、成功/失败音效与特效；协作成功时明确「我们一起做到了」的成就感。

---

## 3. 验证准则 (Validation Heuristics)

### 3.1 深度验证 (Depth Check)
*   **策略空间**: 熟练玩家能通过路线预判与协作节奏，减少失败次数；新手与熟练玩家的差距可通过「重试成本可控」缓和。
*   **重玩价值**: 同一路线，双人协作 vs 单人、不同搭档，体验不同；隐藏/分支路线需协作才有解法。

### 3.2 节奏验证 (Pacing Check)
*   **压力窗口**: 单段攀爬 3–15 分钟；关键协作节点处压力集中。
*   **释放窗口**: 到达检查点、登顶、协作成功后给予喘息与成就感。

---

## 4. 执行细则 (Execution Details)

### 4.1 原子操作 (Atomic Actions)

> **说明**：本小节定义基础移动、攀爬及与攀爬直接相关的操作；托举、拉拽、拉上去等协作动作见《协作与救援》。

| 操作名称 | 触发方式 | 前置条件 | 结果 |
| :--- | :--- | :--- | :--- |
| 基础移动 | 键盘 WASD / 虚拟摇杆 | 角色在地面且非锁定状态 | 以 `MOVE_SPEED` 水平移动，不消耗体力 |
| 奔跑 | 按住 Shift / 虚拟「奔跑」按钮 | 角色在地面移动中，体力 > 0 | 速度切换为 `RUN_SPEED`；在速度变更为奔跑的首帧，立即扣除一次体力，此后按 `STAMINA_COST_RUN_PER_SEC` **每秒**扣除体力（未满 1 秒的时间段在退出奔跑或状态切换时按比例预先结算） |
| 基础跳跃 | 空格 / 虚拟「跳跃」按钮 | 角色处于地面 / 移动 / 奔跑状态 | 以 `JUMP_HEIGHT` 起跳；静止/移动/奔跑不影响跳跃高度；**不消耗体力** |
| 攀爬 | **同时按下方向键 + 长按鼠标左键 / 虚拟「攀爬」按钮** | 角色身体触碰到被判定为「可攀爬斜面」的范围 | 在玩家有明确朝向输入（任一方向键）且按下攀爬键时，检测到斜面即可**进入攀爬状态**：角色身体吸附在斜面上；在**保持贴附但不产生位移**时，按较低档的「持续扣除体力」；当在 W/S/A/D 任一方向上产生位移时，按较高档的「持续扣除体力」（具体数值见数值文档）；W 调整为向高处攀登，S 向下，A 沿斜面向左，D 沿斜面向右；在攀爬状态下**松开攀爬按键时，角色保持悬挂在斜面上，不会立即下落**，需配合「攀爬跳跃」或「释放支点」等操作才会脱离斜面 |
| 攀爬跳跃 | 空格 | 角色处于攀爬状态 | 角色脱离斜面，并沿当前输入方向跳跃一段距离；<br>向上方攀爬跳跃时，以「`CLIMB_JUMP_HEIGHT` × 斜面摩擦力系数」定义最大高度，同时扣除 `CLIMB_JUMP_STAMINA_COST`；<br>向两侧跳跃时，视力矩分布与摩擦力，距离可能缩减，同样消耗 `CLIMB_JUMP_STAMINA_COST`；<br>向下方攀爬跳跃时，不消耗体力，向背离斜面侧少许位移，在原地脱离斜面 |
| 自动站立 | 无（系统判定） | 角色处于攀爬状态，且脚部触及到「可站立地面」判定 | 自动解除攀爬状态，角色在地面上进入站立状态 |
| 翻越动作 | 无（系统判定 / 轻量输入触发，具体实现待定） | 角色处于攀爬状态，头部等高触及到上方「可站立区域」 | 触发「翻越动作」，角色站立在高处可站立区域 |
| 抓取支点 | 按键/触控 | 在支点范围内 | 角色吸附支点，可进行位移 |
| 释放支点 | 松开 | 已抓取支点 | 脱离支点，可能下落 |
| 借力跳跃 | 按键 | 在借力支点/搭档附近 | 获得额外冲量，到达更高支点 |
| 托举 | 在平地上按下鼠标左键 / 「虚拟交互」键 | 角色处于可站立平地且附近存在可托举对象 | 进入「托举状态」：托举者缩小碰撞体积，在其碰撞范围内**首先与之重叠身位的 1 位玩家**进入「受托举状态」；受托举者在该状态下进行跳跃时，触发「受托举跳跃」动作，高度高于基础跳跃；若受托举者从任意方向尝试离开重叠身位，则托举者做出小幅对应朝向的托举动作并脱离托举，受托举者获得一小段额外高度；协作逻辑与关系门控详见《协作与救援》 |

| 拉拽 | 鼠标左键 / 「交互」键 | 搭档处于攀爬状态，位于拉拽者一定距离范围内，且高度低于拉拽者，拉拽者处于可站立状态 | 不需要额外朝向输入：在满足上述条件时，拉拽者点击鼠标左键 / J 自动对最近满足条件的目标执行拉拽，将目标**拉至拉拽者当前位置**（含合理的对齐与落脚判定）；协作逻辑与关系门控详见《协作与救援》 |
### 4.2 对象状态 (Object States)
*   **角色**: 站立/移动/奔跑 → [跳跃] → 自由下落 → [抓取支点 / 进入可攀爬斜面] → 攀爬中 → [攀爬跳跃 / 释放] → 自由下落 / 到达新支点 / 翻越至上方可站立区域 / 自动站立回到地面
*   **协作节点**: 未触发 → [双方进入区域+输入] → 协作成功 / 协作失败（超时/错位）；详见《协作与救援》。

### 4.3 角色基础移动与体力常量（CA 表定义）

> **来源**: 《基础行为》文档中关于移动速度、奔跑速度、体力与攀爬消耗的约定。

本节定义用于驱动角色基础移动、奔跑、跳跃与攀爬相关体力消耗的关键常量，统一存于 `CA_BASE_CHARACTER_MOVEMENT` 常量表中。

| 常量名 | 类型 | 单位 | 说明 | 备注示例 |
| :--- | :--- | :--- | :--- | :--- |
| `MOVE_SPEED` | float | m/s | 角色在地面基础移动速度 | 如 3.5 |
| `RUN_SPEED` | float | m/s | 角色在地面奔跑速度 | 如 5.5 |
| `STAMINA_MAX` | float | 点 | 角色体力上限 | 如 100；实际由《状态系统》与成长决定 |
| `STAMINA_COST_RUN_PER_SEC` | float | 点/秒 | 奔跑状态下每秒体力消耗 | 首帧额外扣一次，之后按秒结算 |
| `JUMP_HEIGHT` | float | m | 地面基础跳跃高度 | 与重力参数共同决定腾空时间 |
| `CLIMB_STAMINA_COST_PER_SEC` | float | 点/秒 | 攀爬状态下每秒体力消耗 | 进入攀爬后的连续消耗 |
| `CLIMB_JUMP_HEIGHT` | float | m | 攀爬跳跃基础高度 | 实际高度 = `CLIMB_JUMP_HEIGHT × 斜面摩擦力系数` |
| `CLIMB_JUMP_STAMINA_COST` | float | 点/次 | 向上/侧向攀爬跳跃的体力消耗 | 向下攀爬跳跃不消耗体力 |

**体力结算规则补充**：

*   **奔跑体力**：从「非奔跑状态」切换为「奔跑状态」的首帧，立即扣除一次 `STAMINA_COST_RUN_PER_SEC`；此后每满 1 秒结算一次消耗。若玩家在不足 1 秒内停止奔跑或切换状态，则按本次奔跑实际持续时间占 1 秒的比例，预先结算体力消耗。
*   **攀爬体力**：进入攀爬状态的首帧不做额外扣除，从进入攀爬时刻起按真实时间连续扣除 `CLIMB_STAMINA_COST_PER_SEC`。体力为 0 时，不再允许触发新的攀爬跳跃，角色倾向于向下滑落或回到可站立状态（具体失败反馈见 Demo 调优）。

### 4.4 物理参数与运动模型（Physics Model）

> **目标风格**：以偏写实的「登山感」为基调（重力感、滑落风险真实可信），同时引入一组友好的输入容错机制（coyote time、跳跃缓冲、攀爬吸附辅助等），降低操作挫败。

#### 4.4.1 全局物理常量

本节为角色运动相关的物理参数定义建议，统一存于 `CA_BASE_PHYSICS` 常量表中。

| 常量名 | 类型 | 单位 | 说明 | 备注示例 |
| :--- | :--- | :--- | :--- | :--- |
| `GRAVITY` | float | m/s² | 世界重力加速度 | 建议略高于现实，如 11–13，用于强调坠落危险感 |
| `TERMINAL_VELOCITY_FALL` | float | m/s | 角色终端下落速度上限 | 控制最大落地速度与受伤阈值 |
| `GROUND_FRICTION` | float | - | 地面摩擦系数 | 影响刹车距离、停下滑步长度 |
| `AIR_CONTROL_FACTOR` | float | - | 空中水平控制系数 | 0 表示不可控，1 表示与地面相同，推荐 0.3–0.5 |
| `SLOPE_MAX_WALK_ANGLE` | float | ° | 仍视为「可行走地面」的最大坡度 | 超过则视为滑面或需攀爬 |
| `SLOPE_MIN_CLIMB_ANGLE` | float | ° | 可判定为「可攀爬斜面」的最小坡度 | 介于 WALK_ANGLE 与 90° 之间的区间 |
| `SLOPE_SLIDE_FRICTION` | float | - | 在超陡斜面上滑动时的有效摩擦系数 | 决定滑落速度 |
| `ACCEL_GROUND` | float | m/s² | 地面起步加速度 | 控制起步“发力感”，偏写实可略低，依赖预判 |
| `DECEL_GROUND` | float | m/s² | 地面减速度 | 控制刹停距离，配合 `GROUND_FRICTION` 调整 |

**实现建议**：

*   **速度整形**：地面水平速度不应瞬间从 0 切到 `MOVE_SPEED`/`RUN_SPEED`，而是通过 `ACCEL_GROUND` 逐帧逼近；同理减速通过 `DECEL_GROUND` 和 `GROUND_FRICTION` 渐停，形成轻微「滑步感」，体现写实登山的重量感。
*   **终端速度与坠落后果**：当垂直速度趋近 `TERMINAL_VELOCITY_FALL` 后不再继续加速，下落落地时可与受伤或 Knockdown 逻辑挂钩（是否启用受伤机制由《状态系统》等规范决定，本处仅定义速度上限）。

#### 4.4.2 斜坡与斜面判定

为统一「可行走地面」「滑落斜坡」「可攀爬斜面」的逻辑，采用法线夹角进行划分：

*   若地面法线与重力方向夹角 \( \theta \) 满足：  
    * \( \theta \le SLOPE_MAX_WALK_ANGLE \)：判定为**可行走地面**，角色使用「站立/移动/奔跑」逻辑；在极限角度附近可产生轻微向下滑动。
    * \( SLOPE_MAX_WALK_ANGLE < \theta < SLOPE_MIN_CLIMB_ANGLE \)：判定为**危险斜坡**，可行走但存在明显滑落趋势；`SLOPE_SLIDE_FRICTION` 决定滑落速度。
    * \( \theta \ge SLOPE_MIN_CLIMB_ANGLE \)：判定为**可攀爬斜面**，可触发「攀爬」或「攀爬跳跃」。

> **与 4.1 对齐**：当角色位于「可攀爬斜面」上并满足 4.1 中的前置条件时，允许通过「点击鼠标左键 / 虚拟攀爬按钮」进入攀爬状态。当角色在「危险斜坡」上未进入攀爬状态，仅以行走逻辑尝试前进时，应产生向下滑落趋势，推动玩家做出「攀爬」或「绕路」决策。

#### 4.4.3 攀爬状态中的运动

在攀爬状态下，角色沿斜面切线/法线方向运动，受摩擦力和体力双重约束：

*   **沿斜面移动速度**：可定义 `CLIMB_MOVE_SPEED`（另行加入 CA 表）作为基准速度，受斜面角度和 `SLOPE_SLIDE_FRICTION` 调整。角度越大、摩擦越小，越难向上攀登。
*   **向上攀爬的失败反馈**：当体力不足或角度/摩擦组合导致有效上攀速度低于某阈值时，可触发「原地打滑」或缓慢下滑；具体表现由 Demo 调优。
*   **攀爬跳跃轨迹**：向上/侧向时，以 `CLIMB_JUMP_HEIGHT` 为基础高度，再乘 `斜面摩擦力系数` 与「起跳方向与法线夹角」的函数，保证「顺着墙往上蹬比侧跃更高」。向下时不受体力约束，以较小抛物线脱离斜面，强化“撤退安全”的策略选项。

#### 4.4.4 输入容错与吸附辅助

在写实基调之上，引入以下「友好机制」减少挫败：

*   **Coyote Time（悬空缓冲）**：当角色刚刚离开可站立边缘进入下落状态的极短时间窗口内（如 0.1–0.2 秒），若玩家按下跳跃键，仍视为在地面起跳，使用 `JUMP_HEIGHT` 计算轨迹。该时间窗口可用 `JUMP_COYOTE_TIME` 常量定义。
*   **Jump Buffer（提前按键缓冲）**：当角色还在空中接近地面时，如玩家在 \( t \) 秒内（如 0.1–0.2 秒）提前按下跳跃键，则在角色满足「落地」条件的下一帧自动触发一次跳跃。可用 `JUMP_BUFFER_TIME` 常量定义。
*   **攀爬吸附辅助**：当角色在空中接近「可攀爬斜面」且满足：距离斜面小于某阈值（`CLIMB_AUTO_SNAP_DISTANCE`），且朝向与斜面法线夹角在容差范围内（`CLIMB_AUTO_SNAP_ANGLE`），且玩家在这段时间内有主动输入「攀爬」操作，则自动将角色位置与姿态「对齐」到斜面上，并进入攀爬状态，避免因几厘米的判定误差导致错失攀爬机会。
*   **边缘吸附与翻越判定容差**：对 4.1 中的「自动站立」「翻越动作」，在垂直方向上引入小范围容差（如 ±10–20 cm），使用 `AUTO_STAND_HEIGHT_TOLERANCE`、`VAULT_HEIGHT_TOLERANCE` 常量控制，防止因模型/地形微小误差导致体验不一致。

> **体验原则**：写实部分主要通过「重力感、滑落风险、加减速与摩擦」体现。友好部分主要通过「输入缓冲、吸附与容差」隐藏判定苛刻性，让玩家感受到的是“自己预判得不错”，而不是“被系统坑了半个身位”。

---

## 5. 与系统架构的映射

| 系统 | 本规范覆盖 |
| :--- | :--- |
| [SYS_CLIMB] 攀爬与移动 | 抓取、释放、借力、支点判定、攀爬与攀爬跳跃体力消耗、物理与运动模型 |
| [SYS_COOP] 协作与救援 | 托举、拉拽、拉上去、协作节点、互助行为与关系门控；见《02_协作与救援》 |
| [SYS_STATE] 状态系统 | 体力消耗与 Action_Bar 对接；见《04_状态系统》 |
| [SYS_ROUTE] 路线/关卡 | 主线/分支划分、协作节点配置；见《03_环境与关卡》 |

---

## 6. Unreal Engine 实现约定（Mapping to UE）

> **目的**：本节将本规范中的关键常量与 UE `CharacterMovementComponent` 及相关系统的参数建立一一对应关系，方便程序与 TA 在不额外修改物理引擎的前提下直接落地。

### 6.1 常量 ↔ UE 参数对照表

| 设计常量 / 概念 | UE 参数 / 实现位置 | 说明 |
| :--- | :--- | :--- |
| `MOVE_SPEED` | `CharacterMovement.MaxWalkSpeed`（行走态） | 地面基础移动速度。进入非奔跑状态时设置为该值。 |
| `RUN_SPEED` | `CharacterMovement.MaxWalkSpeed`（奔跑态） | 按住 Shift / 奔跑输入时，将 `MaxWalkSpeed` 切换为该值。 |
| `STAMINA_MAX` / `CurrentStamina` | 角色自定义字段（C++/蓝图变量） | 体力系统不依赖 UE 内置字段，由角色/Ability 系统维护。 |
| `STAMINA_COST_RUN_PER_SEC` | 角色 Tick / 计时器逻辑 | 奔跑状态下每秒体力消耗：首帧额外扣一次，其后按秒结算。 |
| `JUMP_HEIGHT` | 通过 `CharacterMovement.JumpZVelocity` + `WorldGravityZ * GravityScale` **反推** | 以设计给定的跳跃高度为主，再计算出对应的 `JumpZVelocity`，保证高度一致。 |
| `GRAVITY` | `WorldSettings.WorldGravityZ` + `CharacterMovement.GravityScale` | 世界重力与角色缩放的组合，数值上应与本规范的 `GRAVITY` 对齐。 |
| `TERMINAL_VELOCITY_FALL` | `CharacterMovement.MaxFallSpeed` | 最大下落速度上限。可作为坠落受伤/击倒判定的参考。 |
| `GROUND_FRICTION` | `CharacterMovement.GroundFriction` | 地面摩擦系数，影响减速与滑步感。 |
| `ACCEL_GROUND` | `CharacterMovement.MaxAcceleration` | 地面起步加速度。建议结合手感微调。 |
| `DECEL_GROUND` | `CharacterMovement.BrakingDecelerationWalking` | 地面减速度。与 `GROUND_FRICTION` 一起决定刹停距离。 |
| `AIR_CONTROL_FACTOR` | `CharacterMovement.AirControl` | 空中水平控制能力，推荐 0.3–0.5，体现有限姿态修正。 |
| `SLOPE_MAX_WALK_ANGLE` | `CharacterMovement.WalkableFloorAngle` | 最大可视为「可行走地面」的坡度；超过视为危险斜坡或需攀爬区域。 |
| `SLOPE_MIN_CLIMB_ANGLE` | 自定义攀爬检测逻辑中使用（墙面法线角度） | 判定「可攀爬斜面」的最小坡度阈值，不直接对应 UE 内置字段。 |
| `SLOPE_SLIDE_FRICTION` | 自定义逻辑：在危险斜坡上调整 `GroundFriction` 或施加向下速度 | 决定在危险斜坡上的滑落速度与难度。 |
| `CLIMB_STAMINA_COST_PER_SEC` | 攀爬 MovementMode 下的体力消耗逻辑 | 每秒攀爬体力消耗，在 `MOVE_Climb` 的 Tick 中结算。 |
| `CLIMB_JUMP_HEIGHT` | 在攀爬状态下计算起跳速度向量的基础高度 | 结合墙面法线与摩擦系数计算「攀爬跳跃」的实际抛物线。 |
| `CLIMB_JUMP_STAMINA_COST` | 攀爬跳跃逻辑 | 向上/侧向攀爬跳跃的体力消耗。向下不消耗体力。 |
| `CLIMB_MOVE_SPEED`（建议新增） | 攀爬 MovementMode 下的自定义速度变量 | 控制沿斜面上下/左右移动速度。 |
| `JUMP_COYOTE_TIME` | 角色自定义字段 + MovementMode 切换回调 | 从 `Walking` → `Falling` 后的时窗内仍允许触发跳跃。 |
| `JUMP_BUFFER_TIME` | 角色自定义字段 + 跳跃输入缓存 | 在落地前短时间内预先按下跳跃键，落地后自动触发一次跳跃。 |
| `CLIMB_AUTO_SNAP_DISTANCE` | 攀爬检测用的 Trace 半径 / 距离阈值 | 决定空中/行走接近斜面时是否允许「吸附式」进入攀爬。 |
| `CLIMB_AUTO_SNAP_ANGLE` | 攀爬检测逻辑中对角色朝向与墙面法线夹角的容差 | 角色朝向与墙面差距在该角度内时，允许自动吸附。 |
| `AUTO_STAND_HEIGHT_TOLERANCE` | 自动站立判定中的高度容差 | 攀爬脚部触地时，容忍的小高度差，决定是否自动切回站立。 |
| `VAULT_HEIGHT_TOLERANCE` | 翻越动作判定中的高度容差 | 攀爬头部接近上方可站立区域时的高度容差，决定是否触发翻越。 |

### 6.2 攀爬 MovementMode 实现约定（简要）

*   **自定义 MovementMode**：在 `CharacterMovementComponent` 中新增 `MOVE_Custom` 子类型 `MOVE_Climb`，并在 `PhysCustom` 中实现具体攀爬行为。
*   **状态切换**：`Walking` / `Falling` → `MOVE_Climb`：满足「可攀爬斜面 + 距离阈值 + 玩家攀爬输入」条件时触发。`MOVE_Climb` → `Falling` / `Walking`：体力耗尽、松手、攀爬跳跃或达到「自动站立/翻越」条件时退出。
*   **输入映射**：在 `MOVE_Climb` 下，W/S/A/D 重新映射为「沿斜面上下/左右位移」，空格触发「攀爬跳跃」，具体规则见 4.1 与 4.4.3。
*   **体力与失败反馈**：所有与体力相关的行为结算（奔跑、攀爬、攀爬跳跃）以本规范的 CA 表为准，UE 仅作为数值载体与物理解算器；当 `CurrentStamina <= 0` 时，强制阻止新的高消耗动作，并通过 MovementMode 切换与动画表现「滑落 / 撤退」。

> **实现说明**：如 UE 内置字段与本规范存在冲突，以本规范为准；程序可在不修改引擎源码的前提下，通过组合 `CharacterMovementComponent`、自定义 MovementMode、Trace 检测与体力系统实现全部预期行为。
