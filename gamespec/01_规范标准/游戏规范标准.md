# GameSpec - 游戏策划文档标准 / Game Design Document Standard

> 参考 OpenSpec 规范驱动开发思想，专为游戏开发团队设计的策划文档标准

---

## 目录 / Table of Contents

1. [核心理念 / Core Philosophy](#1-核心理念--core-philosophy)
2. [目录结构 / Directory Structure](#2-目录结构--directory-structure)
3. [文档类型 / Document Types](#3-文档类型--document-types)
4. [通用格式规范 / Universal Format](#4-通用格式规范--universal-format)
5. [变更追踪机制 / Change Tracking](#5-变更追踪机制--change-tracking)
6. [验证规则 / Validation Rules](#6-验证规则--validation-rules)
7. [命名规范 / Naming Conventions](#7-命名规范--naming-conventions)
8. [快速参考 / Quick Reference](#8-快速参考--quick-reference)

---

## 1. 核心理念 / Core Philosophy

### 1.1 数据完整性原则 / Data Integrity Principles (CRITICAL)

这是 GameSpec 体系的**最高指令**。无论是人类策划还是 AI 助手，在修改、迭代文档时，**必须 (MUST)** 遵守以下原则：

| 原则 | 说明 | Principle | Description |
|------|------|-----------|-------------|
| **全量保留** | 改写文档时，严禁因“篇幅限制”或“认为不重要”而自动删除任何内容。 | Full Retention | NEVER delete content due to length limits or assumption of irrelevance. |
| **禁止缩略** | 严禁使用“略”、“...”、次级标题下只写“同上”或“详见xx版本”等幻觉缩略行为。 | No Abbreviation | 'Ibid', 'See previous', '...' are STRICTLY PROHIBITED in core specs. |
| **显式删除** | 只有在用户明确指令删除，或内容被标记为 `DEPRECATED` 时，才能移除内容。 | Explicit Deletion | Delete ONLY upon explicit user instruction or deprecation tag. |
| **单一事实** | 核心内容必须保留在当前文档中，禁止将其拆分为不完整的碎片。 | Single Source | Keep core content self-contained. Do not fragment into incomplete parts. |

> **警告**: 违反此原则将被视为严重的**数据破坏事故**。

### 1.2 设计原则 / Design Principles

| 原则 | 说明 | Principle | Description |
|------|------|-----------|-------------|
| **先设计后开发** | 策划文档是开发的依据，不是事后补充 | Design First | Documents drive development, not vice versa |
| **可验证性** | 每个设计点都有明确的验收标准 | Verifiable | Every design has clear acceptance criteria |
| **增量迭代** | 通过 Delta 机制追踪设计变更 | Incremental | Track changes through Delta mechanism |
| **场景驱动** | 用具体场景描述游戏体验 | Scenario-Driven | Describe gameplay through scenarios |
| **单一职责** | 每份文档聚焦一个系统/功能 | Single Focus | Each document focuses on one system |

### 关键字约定 / Keywords

| 关键字 | 含义 | Keyword | Meaning |
|--------|------|---------|---------|
| **必须 / MUST** | 强制要求，不可省略 | Mandatory requirement |
| **应该 / SHOULD** | 推荐做法，除非有充分理由 | Recommended unless justified |
| **可以 / MAY** | 可选功能 | Optional feature |
| **禁止 / MUST NOT** | 明确禁止 | Explicitly forbidden |

---

## 2. 目录结构 / Directory Structure

请严格遵循 **[文档与目录规范](文档与目录规范.md)** 中的定义。

> **注意**: 本文档不再重复定义目录结构。任何关于文件存放位置、目录层级的疑问，请直接查阅《文档与目录规范》。

---

## 3. 文档类型 / Document Types

### 3.1 核心流程文档 (Core Workflow Docs)

GameSpec 采用四层金字塔模型。所有文档均 **必须 (MUST)** 基于 `gamespec/02_项目模板/` 下的标准模板创建。

**文档映射表**:

| 层级 | 英文 ID (参考) | 对应标准模板文件 |
| :--- | :--- | :--- |
| **根基层** | Project Concept | `01_立项企划/游戏概念书.md`, `01_立项企划/创意验证书.md`, `06_世界观/` |
| **架构层** | Architecture | `02_技术架构/系统架构图.md`, `03_系统设计/核心玩法规范.md` |
| **系统层** | Systems | `03_系统设计/系统设计规范.md` (用于战斗/养成/社交等) |
| **内容层** | Content | `02_技术架构/内容规划规范.md`, `04_内容创作/叙事规范.md`, `04_内容创作/关卡设计规范.md` |

---

## 3. 文档类型 / Document Types

### 3.1 系统设计文档 / System Design Document

**用途**: 定义游戏核心系统的规则和行为

**结构**:

```markdown
# [系统名称] System / [System Name] 系统

## 概述 / Overview
[系统的核心目标，50-200字]

## 核心规则 / Core Rules

### 规则: [规则名称] / Rule: [Rule Name]
[使用 必须/MUST 或 应该/SHOULD 描述规则]

#### 场景: [场景名称] / Scenario: [Scenario Name]
- **当 / WHEN** [触发条件]
- **则 / THEN** [预期结果]
- **且 / AND** [附加条件]（可选）

## 数值引用 / Numeric References
- 配置表: `config/[table-name].xlsx`
- 公式文档: `numerics/[category]/spec.md`

## 关联系统 / Related Systems
- [其他系统引用]

## 美术需求 / Art Requirements
- [资源需求引用]

## 音效需求 / Audio Requirements
- [音效需求引用]
```

### 3.2 数值设计文档 / Numeric Design Document

**用途**: 定义数值设计意图，引用具体配置表

**结构**:

```markdown
# [数值类别] Numeric Design / [Category] 数值设计

## 设计目标 / Design Goals
[数值设计的核心体验目标]

## 核心公式 / Core Formulas

### 公式: [公式名称] / Formula: [Formula Name]
**意图 / Intent**: [这个公式要达成什么体验]
**引用 / Reference**: `excel/[filename].xlsx![SheetName]`

#### 验证场景 / Validation Scenario
- **输入 / Input**: [示例输入值]
- **预期输出 / Expected**: [预期结果]
- **体验说明 / Experience**: [玩家感受]

## 平衡目标 / Balance Targets

### 目标: [目标名称] / Target: [Target Name]
- **指标 / Metric**: [具体指标]
- **目标值 / Target Value**: [目标范围]
- **验证方法 / Validation**: [如何验证]

## 配置表索引 / Config Table Index
| 表名 / Table | 路径 / Path | 说明 / Description |
|--------------|-------------|---------------------|
| [表名] | `excel/[path]` | [用途说明] |
```

### 3.3 关卡设计文档 / Level Design Document

**结构**:

```markdown
# [关卡ID] Level Design / [Level ID] 关卡设计

## 基础信息 / Basic Info
- **关卡ID / Level ID**: [唯一标识]
- **所属章节 / Chapter**: [章节信息]
- **预计时长 / Duration**: [分钟]
- **难度 / Difficulty**: [难度等级]

## 设计目标 / Design Goals
[关卡要传达的核心体验]

## 通关条件 / Victory Conditions

### 条件: [条件名称] / Condition: [Condition Name]
[描述，使用 必须/MUST]

#### 场景: [场景名称] / Scenario
- **当 / WHEN** [玩家行为]
- **则 / THEN** [判定结果]

## 失败条件 / Failure Conditions
[同上格式]

## 关卡流程 / Level Flow
1. [阶段1描述]
2. [阶段2描述]
...

## 敌人配置 / Enemy Configuration
| 敌人 / Enemy | 数量 / Count | 位置 / Position | 行为 / Behavior |
|--------------|--------------|-----------------|-----------------|

## 奖励配置 / Reward Configuration
| 条件 / Condition | 奖励 / Reward | 数量 / Amount |
|------------------|---------------|---------------|

## 资源需求 / Asset Requirements
- 场景: [场景资源引用]
- 音效: [音效资源引用]
```

### 3.4 任务/剧情文档 / Quest & Story Document

**结构**:

```markdown
# [任务线ID] Quest Line / [Quest Line ID] 任务线

## 基础信息 / Basic Info
- **任务线ID / Quest Line ID**: [唯一标识]
- **类型 / Type**: [主线/支线/日常]
- **前置条件 / Prerequisites**: [解锁条件]

## 剧情概要 / Story Summary
[100-300字剧情概述]

## 任务列表 / Quest List

### 任务: [任务名称] / Quest: [Quest Name]
- **任务ID / Quest ID**: [唯一标识]
- **前置任务 / Prerequisites**: [前置任务ID]

#### 目标 / Objectives
1. [目标描述，使用 必须/MUST]

#### 对话节点 / Dialogue Nodes
| 节点ID / Node ID | 说话者 / Speaker | 对话键 / Text Key |
|------------------|------------------|-------------------|
| [ID] | [NPC名称] | `LOC_QUEST_XXX_001` |

#### 奖励 / Rewards
| 类型 / Type | 物品 / Item | 数量 / Amount |
|-------------|-------------|---------------|

## 本地化引用 / Localization Reference
- 对话文本: `localization/quests/[quest-id].xlsx`
```

### 3.5 UI/UX 设计文档 / UI/UX Design Document

**结构**:

```markdown
# [界面名称] UI Spec / [Screen Name] 界面规范

## 基础信息 / Basic Info
- **界面ID / Screen ID**: [唯一标识]
- **入口 / Entry Points**: [如何进入该界面]
- **线框图 / Wireframe**: `designs/ui/[screen-id].fig`

## 功能说明 / Functions

### 功能: [功能名称] / Function: [Function Name]
[功能描述，使用 必须/MUST]

#### 交互场景 / Interaction Scenario
- **当 / WHEN** [用户操作]
- **则 / THEN** [界面响应]

## 界面元素 / UI Elements
| 元素ID / Element | 类型 / Type | 说明 / Description | 本地化键 / Loc Key |
|------------------|-------------|---------------------|-------------------|

## 状态说明 / States
| 状态 / State | 触发条件 / Trigger | 显示内容 / Display |
|--------------|---------------------|---------------------|

## 动效说明 / Animations
| 动效 / Animation | 触发 / Trigger | 时长 / Duration | 缓动 / Easing |
|------------------|----------------|-----------------|---------------|

## 资源需求 / Asset Requirements
- 图标: [图标资源引用]
- 音效: [音效资源引用]
```

### 3.6 资源需求文档 / Asset Requirement Document

**结构**:

```markdown
# [资源类别] Asset Spec / [Category] 资源规范

## 命名规范 / Naming Convention
- **前缀 / Prefix**: [资源类型前缀]
- **格式 / Format**: `[prefix]_[category]_[name]_[variant]`
- **示例 / Example**: `tex_ui_btn_confirm_normal`

## 资源列表 / Asset List

### 资源: [资源名称] / Asset: [Asset Name]
- **资源ID / Asset ID**: [唯一标识]
- **类型 / Type**: [纹理/模型/动画/音效]
- **规格 / Spec**: [分辨率/多边形数/时长等]
- **风格参考 / Style Ref**: [参考图/音频链接]
- **优先级 / Priority**: [P0/P1/P2]
- **使用场景 / Usage**: [在哪里使用]

## 本地化资源 / Localized Assets
| 资源ID / Asset ID | 需要本地化 / Localize | 语言 / Languages |
|-------------------|----------------------|------------------|
```

---

## 4. 通用格式规范 / Universal Format

### 4.1 文档头部 / Document Header

每个规范文档必须包含元信息:

```markdown
---
id: [唯一标识]
version: [版本号，如 1.0.0]
status: [draft/review/approved/deprecated]
author: [作者]
created: [创建日期 YYYY-MM-DD]
updated: [更新日期 YYYY-MM-DD]
reviewers: [审核人列表]
---
```

### 4.2 必需部分 / Required Sections

| 文档类型 | 必需部分 |
|----------|----------|
| 系统设计 | 概述、核心规则（至少1条）、至少1个场景 |
| 数值设计 | 设计目标、配置表索引 |
| 关卡设计 | 基础信息、通关条件、关卡流程 |
| 任务设计 | 基础信息、任务列表（至少1个） |
| UI 设计 | 基础信息、功能说明、界面元素 |
| 资源需求 | 命名规范、资源列表（至少1个） |

### 4.3 规则格式 / Rule Format

```markdown
### 规则: [规则名称] / Rule: [Rule Name]
[规则描述，必须使用 必须/MUST 或 应该/SHOULD 描述规则]

#### 场景: [场景名称] / Scenario: [Scenario Name]
- **当 / WHEN** [触发条件]
- **则 / THEN** [预期结果]
- **且 / AND** [附加条件]（可选）
- **否则 / ELSE** [异常处理]（可选）
```

### 4.4 引用格式 / Reference Format

```markdown
## 外部引用 / External References
- 配置表: `excel/[category]/[filename].xlsx![SheetName]`
- 其他规范: `gamespec/[type]/[name]/spec.md#[anchor]`
- 资源文件: `assets/[category]/[filename].[ext]`
- 本地化: `LOC_[CATEGORY]_[ID]_[SUFFIX]`
```

### 4.5 变量化引用 / Variable Reference (NEW)

为了确保文档与配置的一致性，设计文档中 **禁止 (MUST NOT)** 出现具体的“魔法数字”。

- **配置参数**: 使用双大括号 `{{PARAM_NAME}}`。
- **配置表引用**: 使用 `[ConfigName]![Key]`。
- **通用机制引用**: 必须链接到 `02_项目模板/通用机制库.md`，例如 `[机制:眩晕](../02_项目模板/通用机制库.md#st-stun)`。

#### 示例
- ❌ **Bad**: "火球术造成 **500** 点伤害。"
- ✅ **Good**: "火球术造成 **{{SKILL_FIREBALL_DMG}}** 点伤害。"

---

## 5. 版本控制与变更管理 / Versioning & Change Management

### 5.1 不可变性原则 / Immutability Principle (CRITICAL)

为了保证设计历史的可追溯性，GameSpec 采用 **"写时复制 (Copy-on-Write)"** 的版本控制策略。

| 规则 | 说明 | Rule | Description |
|------|------|------|-------------|
| **禁止覆盖** | 严禁直接修改并覆盖（Overwrite）已发布的旧文档。 | No Overwrite | NEVER overwrite existing published documents. |
| **强制归档** | 每次修改前，**必须**先将旧文件移动到归档目录。 | Archive First | MUST move old file to archive before editing. |
| **版本递增** | 新生成的文件必须更新 `version` 字段。 | Version Bump | New file MUST have incremented version. |

### 5.2 归档流程 / Archiving Workflow

当需要修改 `docs/combat_system.md` (v1.0) 时，执行以下步骤：

1.  **创建归档目录**: 检查 `docs/archive/` 是否存在，不存在则创建。
2.  **移动旧文件**: 将 `docs/combat_system.md` 移动到 `docs/archive/combat_system_v1.0.md`。
    *   *命名格式*: `[Filename]_v[Version].[ext]`
3.  **生成新文件**: 在原路径 `docs/combat_system.md` 创建新文件。
4.  **更新元数据**: 将新文件的 `version` 升级为 `1.1`，并在 `changelog` 中记录变更。

> **注意**: 归档目录结构应保持与源目录一致，或者使用扁平化命名（如上例）。建议使用扁平化命名以简化层级。

### 5.3 变更提案结构 / Change Proposal Structure

```
changes/[change-id]/
├── proposal.md           # 变更提案
├── tasks.md              # 实现任务
├── impact.md             # 影响分析（可选）
└── specs/                # Delta 规范
    └── [affected-area]/
        └── spec.md       # 增量变更
```

### 5.2 proposal.md 格式

```markdown
# 变更: [变更标题] / Change: [Change Title]

## 变更原因 / Why
[50-500字说明为什么需要这个变更]

## 变更内容 / What Changes
- [变更点1]
- [变更点2，标记 **破坏性/BREAKING** 如适用]

## 影响范围 / Impact
- **受影响系统 / Affected Systems**: [系统列表]
- **受影响关卡 / Affected Levels**: [关卡列表]
- **需要修改的配置 / Config Changes**: [配置表列表]
- **需要更新的资源 / Asset Updates**: [资源列表]

## 风险评估 / Risk Assessment
- **复杂度 / Complexity**: [低/中/高]
- **影响玩家数据 / Affects Player Data**: [是/否]
- **需要停服 / Requires Downtime**: [是/否]
```

### 5.3 Delta 规范格式 / Delta Format

```markdown
## 新增规则 / ADDED Rules

### 规则: [新规则名称] / Rule: [New Rule Name]
[规则描述，必须使用 必须/MUST]

#### 场景: [场景名称] / Scenario
- **当 / WHEN** [条件]
- **则 / THEN** [结果]

## 修改规则 / MODIFIED Rules

### 规则: [已有规则名称] / Rule: [Existing Rule Name]
[完整的修改后规则描述]

#### 场景: [场景名称] / Scenario
[完整的修改后场景]

## 移除规则 / REMOVED Rules

### 规则: [要移除的规则] / Rule: [Rule to Remove]
**移除原因 / Reason**: [说明]
**迁移方案 / Migration**: [如何处理]

## 重命名 / RENAMED
- 从 / FROM: `### 规则: [旧名称]`
- 到 / TO: `### 规则: [新名称]`
```

### 5.4 tasks.md 格式

```markdown
## 1. 设计阶段 / Design Phase
- [ ] 1.1 更新系统规范文档
- [ ] 1.2 更新数值配置\n- [ ] 1.3 设计评审

## 2. 开发阶段 / Development Phase
- [ ] 2.1 实现核心逻辑
- [ ] 2.2 配置数据导入
- [ ] 2.3 单元测试

## 3. 美术阶段 / Art Phase
- [ ] 3.1 UI 资源制作
- [ ] 3.2 特效制作

## 4. 测试阶段 / QA Phase
- [ ] 4.1 功能测试
- [ ] 4.2 数值验证
- [ ] 4.3 本地化测试

## 5. 发布阶段 / Release Phase
- [ ] 5.1 文档归档
- [ ] 5.2 配置发布
```

---

## 6. 验证规则 / Validation Rules

### 6.1 数值阈值 / Thresholds

| 项目 | 最小值 | 最大值 | 级别 |
|------|--------|--------|------|
| 概述/Overview 字数 | 50 | 500 | ERROR |
| 变更原因/Why 字数 | 50 | 500 | ERROR |
| 规则描述字数 | 10 | 300 | WARNING |
| 每文档规则数 | 1 | 50 | WARNING |
| 每个变更的 Delta 数 | 1 | 20 | WARNING |
| **魔法数字数量** | 0 | 0 | **ERROR** |

### 6.2 必需关键字 / Required Keywords

| 文档类型 | 必需关键字 |
|----------|------------|
| 系统规则 | 必须/MUST 或 应该/SHOULD |
| 通关条件 | 必须/MUST |
| 任务目标 | 必须/MUST |
| UI 功能 | 必须/MUST 或 应该/SHOULD |

### 6.3 验证级别 / Validation Levels

| 级别 | 说明 | 影响 |
|------|------|------|
| `ERROR` | 严重错误 | 阻止评审/开发 |
| `WARNING` | 需要关注 | 建议修复后再继续 |
| `INFO` | 提示信息 | 可忽略 |

### 6.4 常见错误 / Common Errors

| 错误 | 修复方法 |
|------|----------|
| 规则缺少场景 | 添加至少一个 `#### 场景` |
| 规则缺少关键字 | 使用 必须/MUST 或 应该/SHOULD |
| 概述过短 | 扩展到至少 50 字 |
| 缺少配置表引用 | 添加 `excel/[path]` 引用 |
| 变更缺少 Delta | 在 `specs/` 目录添加增量规范 |

### 6.5 玩法设计验证 (Gameplay Verification)

所有系统设计文档 **必须 (MUST)** 通过 [玩法设计标准](../01_规范标准/玩法设计标准.md) 中的验证清单。

- **核心循环验证**: 系统必须能解释其如何强化项目的核心美学目标。
- **反馈验证**: 所有交互操作 **必须** 定义视觉和听觉反馈。
- **3C 验证**: 涉及操作的系统 **必须** 符合输入延迟和容错标准。

---

## 7. 命名规范 / Naming Conventions

请严格遵循 **[文档与目录规范](文档与目录规范.md)** 中的定义。

> **注意**: 本文档不再重复定义命名规范。任何关于文件名、ID 格式、目录命名的疑问，请直接查阅《文档与目录规范》。

---

## 8. 快速参考 / Quick Reference

### 8.1 文档创建检查清单 / Document Checklist

- [ ] 文档头部元信息完整
- [ ] 概述/Overview 字数 50-500
- [ ] 至少一条规则/Rule
- [ ] 每条规则至少一个场景/Scenario
- [ ] 规则使用 必须/MUST 或 应该/SHOULD
- [ ] 配置表有明确引用路径
- [ ] 本地化文本使用键值引用
- [ ] **无魔法数字**: 所有数值使用 `{{VAR}}` 引用
- [ ] **引用通用库**: 通用机制链接到 `../02_项目模板/通用机制库.md`

### 8.2 变更提案检查清单 / Change Proposal Checklist

- [ ] 变更原因/Why 字数 50-500
- [ ] 列出所有影响范围
- [ ] 创建 Delta 规范
- [ ] Delta 中规则有场景
- [ ] 创建任务清单
- [ ] 评估风险等级

### 8.3 常用模板 / Templates

所有标准模板均位于 `02_项目模板/` 目录下：

*   `系统设计规范.md` (System Design)
*   `数值配置规范.md` (Numeric Config)
*   `关卡设计规范.md` (Level Design)
*   ...

使用时请直接复制对应文件到项目目录。

### 8.4 工作流程 / Workflow

```
1. 需求评审
   ├── 阅读现有规范
   ├── 确认是否需要变更提案
   └── 选择合适的模板 (CN/EN)
   ...
3. 设计评审
   ├── 验证文档格式
   ├── 检查设计标准符合度 (Gameplay Check)
   ├── 检查规则完整性
   ...
```
1. 需求评审
   ├── 阅读现有规范
   ├── 确认是否需要变更提案
   └── 选择合适的模板

2. 撰写设计
   ├── 创建变更目录 changes/[id]/
   ├── 编写 proposal.md
   ├── 编写 Delta 规范
   └── 创建 tasks.md

3. 设计评审
   ├── 验证文档格式
   ├── 检查规则完整性
   └── 确认影响范围

4. 实施阶段
   ├── 按 tasks.md 执行
   ├── 更新配置表
   └── 制作资源

5. 归档阶段
   ├── 合并 Delta 到主规范
   ├── 移动到 archive/
   └── 更新版本号
```

---

## 9. 玩法设计标准 / Gameplay Design Standard

除了文档格式，GameSpec 还提供关于\"如何设计好玩游戏\"的通用指导原则。详细内容请参考：

- **[玩法设计标准 / Gameplay Design Standard](../01_规范标准/玩法设计标准.md)**

该标准涵盖：
- **3C与手感**：控制、摄像机、角色的设计基准
- **反馈与多汁性**：视觉、听觉、UI的反馈要求
- **心流与节奏**：难度曲线与玩家动力学
- **设计验证清单**：用于自查游戏体验质量的 Checklist

建议所有项目在进行具体设计时，引用并遵守此标准中的原则。

---

## 10. 上下文引用法则 (Context Rules)

为了确保设计的一致性，防止“文档孤岛”现象，所有设计文档必须遵循以下引用法则：

### 10.1 纵向一致性 (Vertical Consistency)
所有子系统设计文档 **必须 (MUST)** 显式参考并遵循项目的核心文档：
1.  **核心玩法规范**: 确保新系统不破坏核心体验循环。
2.  **工程技术规范**: 确保数据结构符合技术栈要求。
3.  **世界观规范**: 确保包装文案不违和。

> **冲突处理**: 如果新设计与核心文档冲突，必须要求用户**二次确认**，或修改核心文档。

### 10.2 横向一致性 (Horizontal Consistency)
所有设计文档 **必须 (MUST)** 在开头列出 `关联系统 (Related Systems)`，并要求设计者（或 AI）先阅读这些关联文档。
*   *示例*: 设计“公会系统”前，必须阅读“聊天系统”和“好友系统”的文档，防止功能重叠或逻辑死锁。

---

*GameSpec v1.3.0 - 上下文增强版*
*Updated: 2026-01-28*
