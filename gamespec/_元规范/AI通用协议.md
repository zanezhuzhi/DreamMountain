# AI 通用协议 / AI Meta-Protocols

> **适用范围**: 本文件是 GameSpec 体系下所有智能助手（Agents）的**出厂设置**。
> **强制性**: 所有助手在启动任务前，**必须 (MUST)** 读取并内化本文件中的所有协议。本文件优先级高于助手自身的具体指令。

---

## 1. 交互与共创协议 (Interactive & Co-creation)
<protocol id="interactive_design" priority="critical">

### 1.1 禁止单向输出 (No One-way Output)
*   **规则**: 严禁一次性生成完整的长文档（除非用户明确使用 /force 参数）。
*   **原因**: 避免 AI 产生大量用户难以修改的幻觉内容。

### 1.2 三段式工作流 (Three-Stage Workflow)
所有设计任务必须严格遵循以下循环：
1.  **提案 (Proposal)**: 基于理解，输出大纲、关键决策点或草案。
2.  **确认 (Confirmation)**: 显式暂停，询问用户：“以上方向是否符合预期？”或提供 `<options>` 供选择。
3.  **执行 (Execution)**: 只有在收到用户明确肯定（Y/Yes/Confirm）后，才进行详细内容的撰写或写入文件。

### 1.3 决策权让渡 (Decision Handover)
*   当遇到模糊需求或存在多种设计路径时，**禁止** 替用户做决定。
*   **必须** 列出不同方案的 Pros/Cons（优缺点），让用户做选择题。

</protocol>

---

## 2. 数据完整性协议 (Data Integrity)
<protocol id="data_integrity" priority="highest">

### 2.1 严禁缩略 (No Abbreviation)
*   **规则**: 在输出文件内容时，**严禁** 使用 “（略）”、“...”、“同上”、“详见v1.0” 等省略语。
*   **要求**: 必须输出文件的**全量内容**。哪怕该段落没有修改，也必须原样保留。

### 2.2 严禁删除 (No Deletion)
*   **规则**: 除非用户明确指令删除，否则在修改文档时，不得以“优化”为由删除原有的业务逻辑、数值或设定。
*   **原则**: 宁滥勿缺。

### 2.3 魔法数字清洗 (No Magic Numbers)
*   **规则**: 所有的具体数值（如 `100`, `0.5`）必须抽象为变量（如 `{{BASE_HP}}`）。
*   **例外**: `0`, `1` 等逻辑数值除外。

</protocol>

---

## 3. 上下文感知协议 (Context Awareness)
<protocol id="context_awareness" priority="high">

### 3.1 全局扫描 (Global Scan)
*   **启动动作**: 任务开始前，必须扫描项目根目录（含 `gamespec/` 之外的用户目录）。
*   **宽容解析**: 对于用户自定义的非标文档，必须尝试提取其中的有效业务逻辑，不得因格式问题拒读。

### 3.2 宪法遵循 (Constitution Compliance)
*   **动作**: 设计任何内容前，必须检查 `gamespec/02_项目模板/00_项目核心/` 下的文档。
*   **冲突处理**: 若新需求与 [项目核心] 冲突，**必须** 立即停止并警告用户，请求裁决。

### 3.3 查重机制 (De-duplication)
*   **动作**: 新建文档前，必须检查是否存在同名或语义近似（如 `Pet` vs `Follower`）的文档。
*   **处理**: 若存在，**禁止新建**，转为读取旧文件并进行修改。

</protocol>

---

## 4. 文件操作协议 (File Operations)
<protocol id="surgical_ops" priority="high">

### 4.1 引用完整性 (Link Integrity)
*   **规则**: 修改或移动文件时，必须同步更新所有引用该文件的链接。

### 4.2 版本控制 (Versioning)
*   **规则**: 覆盖重要文档前，**必须** 将旧版本移动到 `archive/` 目录（若无则创建），并添加 `_vX.X` 后缀。

### 4.3 相对路径 (Relative Paths)
*   **规则**: 文档内部的链接必须使用相对路径（如 `../01_规范标准/`），严禁使用绝对路径。

### 4.4 模板写保护 (Template Write Protection)
*   **规则**: **严禁** 向 `gamespec/02_项目模板/` 及其子目录写入任何包含具体项目业务逻辑的文件。
*   **操作**: 
    *   如果任务是“填写文档”，必须先将模板 **复制** 到项目的工作目录（如 `01_Project_Core/`），然后对副本进行修改。
    *   仅当用户明确要求“修改模板本身”（如优化结构、修正错别字）时，才允许写入该目录，且必须进行 **二次确认**。

</protocol>
